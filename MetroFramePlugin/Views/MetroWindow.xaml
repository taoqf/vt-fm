<Window x:Class="MetroFramePlugin.Views.MetroWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
        xmlns:vm="clr-namespace:MetroFramePlugin.ViewModels"
        xmlns:controls="clr-namespace:Victop.Wpf.Controls;assembly=Victop.Wpf.Controls"
        xmlns:local="clr-namespace:MetroFramePlugin"
        Name="mainWindow" Style="{DynamicResource ShadowWindow}">
    <Window.Resources>
        <local:ImgeNameToBackgroundConverter x:Key="imgeNameToBackgroundConverter"/>
      
        <Style x:Key="AddMenu" TargetType="{x:Type controls:VicRadioButtonNormal}">
            <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="FontSize" Value="30"></Setter>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Margin" Value="0"></Setter>
            <Setter Property="Padding" Value="2,0,0,0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type controls:VicRadioButtonNormal}">
                        <BulletDecorator Background="Transparent">
                            <Border x:Name="border"  
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                                Background="{TemplateBinding Background}">
                                <Grid>
                                    <Path Data="M47,1 L47,50.5 M46.5,1 L66.5,1 M66.5,0.5 L66.5,50 M0.5,51 L47.5,51 M66,50.5 L111.5,50.5 M1,51 L1,68 M0.5,67.5 L46.5,67.5 M47,67 L47,113 M46.5,113 L66,113 M65.5,67.5 L65.5,113 M65,67.5 L112.5,67.5 M112,50 L112,68" Fill="Gainsboro"  Height="80"  Stretch="Fill" Stroke="Black" Width="80"/>
                                </Grid>
                            </Border>
                        </BulletDecorator>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="addLogo" TargetType="{x:Type ListBox}">
            <Setter Property="Background" Value="{DynamicResource DataGridRowBackground}"/>
            <Setter Property="Foreground" Value="{DynamicResource DataGridRowForeground}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="ScrollViewer.CanContentScroll" Value="true"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="ItemContainerStyle">
                <Setter.Value>
                    <Style TargetType="{x:Type ListBoxItem}">
                        <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                        <Setter Property="HorizontalContentAlignment" Value="Center"/>
                        <Setter Property="VerticalContentAlignment" Value="Center"/>
                        <Setter Property="Width" Value="130"/>
                        <Setter Property="Height" Value="100"/>
                        <Setter Property="Margin" Value="10"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type ListBoxItem}">
                                    <Border Name="Bd"  BorderThickness="0"  Background="{TemplateBinding Background}">
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="80"/>
                                                <RowDefinition Height="*"/>
                                            </Grid.RowDefinitions>
                                            <controls:VicRadioButtonNormal 
                                                                 FontWeight="Bold" 
                                                                 Foreground="{TemplateBinding Foreground}"
                                                                 Style="{DynamicResource AddMenu}" 
                                                                 FontSize="45"
                                                                 IsChecked="{Binding Path=IsSelected,RelativeSource={RelativeSource TemplatedParent},Mode=TwoWay}"
                                                                 HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                                 VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                                                 Command="{Binding DataContext.btnPluginRunClickCommand,RelativeSource={RelativeSource AncestorType=Window}}" 
                                                                 CommandParameter="{Binding .}"/>
                                            <controls:VicButtonNormal  Grid.Row="1"   Name="btnPluginRun" BorderThickness="0"  Content="添加应用" FontSize="12"
                                                       Width="{TemplateBinding Width}" Foreground="{TemplateBinding Foreground}"
                                                        Background="{TemplateBinding Background}" Margin="0" VerticalAlignment="Center"
                                                         Command="{Binding DataContext.btnPluginRunClickCommand,RelativeSource={RelativeSource AncestorType=Window}}" 
                                                       CommandParameter="{Binding .}"/>

                                        </Grid>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger  Property="IsMouseOver" Value="true">
                                            <Setter Property="BorderBrush" TargetName="Bd" Value="{DynamicResource DataGridRowSelectBgColor}"/>
                                            <Setter Property="Foreground" Value="{DynamicResource SecondMenuItemHotForeground}"/>
                                            <Setter Property="BorderThickness" TargetName="Bd" Value="1"/>
                                            <Setter Property="Cursor" Value="Hand"/>
                                        </Trigger>
                                        <Trigger  Property="IsSelected" Value="true">
                                            <Setter Property="Background" TargetName="Bd" Value="{DynamicResource DataGridRowSelectBgColor}"/>
                                            <Setter Property="Foreground" Value="#19bb9b"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </Setter.Value>
            </Setter>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ListBox}">
                        <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto" Background="{TemplateBinding Background}">
                            <WrapPanel Orientation="Horizontal" IsItemsHost="True" ScrollViewer.CanContentScroll="True"/>
                        </ScrollViewer>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>
    <Window.DataContext>
        <vm:UCMetroWindowViewModel/>
    </Window.DataContext>
    <DockPanel LastChildFill="True">
        <ScrollViewer x:Name="scrollViewer" Width="70" Style="{DynamicResource MenuScrollViewer}">
            <Grid Style="{DynamicResource LeftGrid}">
                <StackPanel>
                    <Image Style="{DynamicResource logoImage}" />
                    <Grid  Margin="0,20,0,0" Width="42" Height="42" Background="{DynamicResource Logo}"  HorizontalAlignment="Center" VerticalAlignment="Center" />                   
                    <Border Background="{DynamicResource SecondMenuItemNormalBorderBrush}" Width="46" Height="1" HorizontalAlignment="Center" Margin="0,17,0,0"/>
                    <Border Background="{DynamicResource SecondMenuItemNormalBorderDropColor}" Width="46" Height="1" HorizontalAlignment="Center"/>
                    <Expander Header="项目名称" Style="{DynamicResource ExpanderFirstLevel}" IsExpanded="True">
                        <ListBox x:Name="listSecondMenuLocal" Style="{DynamicResource ListBoxSecondLevelMenu}" SelectedItem="{Binding SelectedSecondMenuModel}" ItemsSource="{Binding SystemMenuListLocal,UpdateSourceTrigger=PropertyChanged}">
                        </ListBox>
                    </Expander>
                </StackPanel>
            </Grid>
        </ScrollViewer>
        <Grid Name="gridMain">
            <Grid.RowDefinitions>
                <RowDefinition RowDefinition.Height="68"/>
                <RowDefinition RowDefinition.Height="*"/>
            </Grid.RowDefinitions>
            <Grid Name="gridTitle" Grid.Row="0"  Grid.Column="1">
                <!--Width="260"-->
                <StackPanel Orientation="Horizontal" Style="{DynamicResource MainFrmUserStackPanelStyle}">
                    <Grid Name="gridSearch"  Style="{DynamicResource MainFrmSearchGridStyle}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition Width="30"/>
                        </Grid.ColumnDefinitions>
                        <controls:VicTextBoxNormal  Grid.Column="0"  WaterMark="  搜索" Style="{DynamicResource MainFrmSearchBoxStyle}"/>
                        <Grid Grid.Column="1" Height="30" VerticalAlignment="Center" HorizontalAlignment="Center">
                            <Path  Margin="6" Data="M13.5,7 C13.5,10.589851 10.589851,13.5 7,13.5 C3.4101491,13.5 0.5,10.589851 0.5,7 C0.5,3.4101491 3.4101491,0.5 7,0.5 C10.589851,0.5 13.5,3.4101491 13.5,7 z M12,12 L20,20"  RenderTransformOrigin="0.493073170731708,0.37970731707317" Stroke="#333333"/>
                        </Grid>
                    </Grid>
                    <controls:VicButtonImage Name="btnUserLogin" Background="{Binding UserImg, Converter={StaticResource imgeNameToBackgroundConverter}}"
                                         Style="{DynamicResource MainFrmUserPictrueGridStyle}" Command="{Binding btnUserLoginClickCommand}">
                    </controls:VicButtonImage>
                    <controls:VicTextBlockNormal Visibility="Collapsed" Text="{Binding UserName}" Style="{DynamicResource MainFrmUserName}"/>
                    <controls:VicTextBlockNormal Text="{Binding UserName}" Style="{DynamicResource MainFrmUserName}"/>
                </StackPanel>
                <StackPanel Margin="0,10,0,0" Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Top">
                    <!--<Button Name="btnFeedBack" Width="34"  Height="34" Style="{DynamicResource btnMainFeedBackStyle}"/>-->
                    <!--插件集合-->
                    <controls:VicButtonNormal Name="btnPluginList" Style="{DynamicResource btnActivePluginStyle}" ToolTip="窗体切换">
                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="MouseEnter">
                                <i:InvokeCommandAction Command="{Binding btnPluginListMouseEnterCommand}"/>
                            </i:EventTrigger>
                        </i:Interaction.Triggers>
                    </controls:VicButtonNormal>
                    <controls:VicButtonNormal Name="btnChangeSkin" Style="{DynamicResource btnChangeSkinStyle}"  ToolTip="皮肤管理">
                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="Click">
                                <i:InvokeCommandAction Command="{Binding btnChangeSkinClickCommand}"/>
                            </i:EventTrigger>
                        </i:Interaction.Triggers>
                    </controls:VicButtonNormal>
                    <controls:VicButtonNormal Name="btnSet" Visibility="Collapsed" Style="{DynamicResource btnSetStyle}" >
                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="Click">
                                <i:InvokeCommandAction Command="{Binding btnSetClickCommand}"/>
                            </i:EventTrigger>
                        </i:Interaction.Triggers>
                    </controls:VicButtonNormal>
                    <controls:VicButtonNormal Name="btnMini" Style="{DynamicResource btnMiniStyle}" ToolTip="最小化">
                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="Click">
                                <i:InvokeCommandAction Command="{Binding btnMiniClickCommand}"/>
                            </i:EventTrigger>
                        </i:Interaction.Triggers>
                    </controls:VicButtonNormal>
                    <controls:VicButtonNormal Name="btnMax" Style="{DynamicResource btnRestoreStyle}" ToolTip="最大化/还原">
                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="Click">
                                <i:InvokeCommandAction Command="{Binding btnMaxClickCommand}" CommandParameter="{Binding ElementName=btnMax}"/>
                            </i:EventTrigger>
                        </i:Interaction.Triggers>
                    </controls:VicButtonNormal>

                    <controls:VicButtonNormal Name="btnClose" Style="{DynamicResource btnCloseStyle}" ToolTip="关闭">
                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="Click">
                                <i:InvokeCommandAction Command="{Binding btnCloseClickCommand}"/>
                            </i:EventTrigger>
                        </i:Interaction.Triggers>
                    </controls:VicButtonNormal>
                </StackPanel>
            </Grid>
            <Grid Name="gridMid" Grid.Column="1" Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition ColumnDefinition.Width="0" />
                    <ColumnDefinition ColumnDefinition.Width="*" />
                </Grid.ColumnDefinitions>
                <StackPanel Width="10" Grid.Column="0" VerticalAlignment="Center">
                    <controls:VicButtonNormal Name="btnStretch" Height="70" Width="10" Style="{DynamicResource btnStretchStyle}" Margin="-3,0,-4,0"></controls:VicButtonNormal>
                </StackPanel>
                <Grid Grid.Column="1">
                    <controls:VicTabControlNormal Name="MainTabControl" Style="{DynamicResource MainVicTabControlStyle}" ItemsSource="{Binding TabItemList}" SelectedItem="{Binding SelectedTabItem}">
                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="TabItemClosing">
                                <i:InvokeCommandAction Command="{Binding tbctrlTabItemClosingCommand}"/>
                            </i:EventTrigger>
                        </i:Interaction.Triggers>
                    </controls:VicTabControlNormal>
                </Grid>
            </Grid>
            <!--<Label Name="tb"  Content="当前软件已是最新版本（2014-04-23）" Style="{DynamicResource MainFrmBottomGridStyle}"/>-->
        </Grid>
    </DockPanel>
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="Loaded">
            <i:InvokeCommandAction Command="{Binding gridMainLoadedCommand}"  CommandParameter="{Binding ElementName=mainWindow}"/>
        </i:EventTrigger>
    </i:Interaction.Triggers>
</Window>
