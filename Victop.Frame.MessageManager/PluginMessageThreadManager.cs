//------------------------------------------------------------------------------
// <auto-generated>
//     此代码由工具生成
//     如果重新生成代码，将丢失对此文件所做的更改。
// </auto-generated>
//------------------------------------------------------------------------------
namespace Victop.Frame.MessageManager
{
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Text;
    using System.Threading;
    using Victop.Frame.Connection;
    using Victop.Frame.CoreLibrary.Models;

	/// <summary>
	/// 插件消息线程管理 【线程池】
	/// </summary>
	/// <remarks>插件消息线程管理</remarks>
	public class PluginMessageThreadManager
	{
        private static PluginMessageThreadManager instance = null;
  
        public static PluginMessageThreadManager GetInstance()
        {
            if (instance == null)
            {
                instance = new PluginMessageThreadManager();
                //开启线程判断是否超时。
                PluginMessageManager pluginMessageManager = new PluginMessageManager();
                Thread thread = new Thread(new ThreadStart(pluginMessageManager.CheckPluginMessageValid));
                thread.IsBackground = true;
                //thread.Start();
            }
            return instance;
        }
    
		/// <summary>
		/// 线程工作
		/// </summary>
		public virtual void DoWork(RequestMessage messageInfo)
		{
            ThreadPool.QueueUserWorkItem(new WaitCallback(SendMessage), messageInfo);
		}

        /// <summary>
        /// 请求消息体发送
        /// </summary>
        /// <param name="messageInfo">请求消息体</param>
        private void SendMessage(object messageInfo)
        {
            RequestMessageSend messageSend = new RequestMessageSend();
            RequestMessage message=(RequestMessage)messageInfo;
            if (string.IsNullOrEmpty(message.MessageType)||string.IsNullOrEmpty(message.MessageContent))
            {
                return;
            }
            messageSend.SendMessage((RequestMessage)messageInfo);
        }
	}
}

